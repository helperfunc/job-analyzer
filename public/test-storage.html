<!DOCTYPE html>
<html>
<head>
    <title>Storage Test</title>
</head>
<body>
    <h1>LocalStorage Test</h1>
    <button onclick="setScraping()">Set Scraping State</button>
    <button onclick="checkScraping()">Check Scraping State</button>
    <button onclick="clearScraping()">Clear Scraping State</button>
    <div id="result"></div>

    <script>
        function setScraping() {
            const state = {
                isActive: true,
                timestamp: Date.now(),
                url: 'https://openai.com/careers/search/'
            };
            localStorage.setItem('scraping-in-progress', JSON.stringify(state));
            document.getElementById('result').innerHTML = 'Scraping state set: ' + JSON.stringify(state, null, 2);
        }

        function checkScraping() {
            const state = localStorage.getItem('scraping-in-progress');
            if (state) {
                const parsed = JSON.parse(state);
                const now = Date.now();
                const isActive = parsed.isActive && (now - parsed.timestamp) < 10 * 60 * 1000;
                document.getElementById('result').innerHTML = 'Found state: ' + JSON.stringify(parsed, null, 2) + 
                    '<br>Active: ' + isActive + 
                    '<br>Age: ' + Math.round((now - parsed.timestamp) / 1000) + ' seconds';
            } else {
                document.getElementById('result').innerHTML = 'No scraping state found';
            }
        }

        function clearScraping() {
            localStorage.removeItem('scraping-in-progress');
            document.getElementById('result').innerHTML = 'Scraping state cleared';
        }

        // Auto-check on load
        window.onload = checkScraping;
    </script>
</body>
</html>